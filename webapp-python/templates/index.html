<!doctype html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
                <title>{{ title or "Hello World App" }}</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
        <header class="navbar">
                    <div class="nav-left">
                            <a class="btn-nav" href="/home">Home</a>
                        <a class="btn-nav" href="/about">About</a>
                        <a id="login-link" class="btn-nav" href="/login">Login</a>
                </div>
                <div class="nav-right">
                        <span id="user-name" aria-live="polite"></span>
                        <button id="logout-btn" class="btn-nav hidden">Logout</button>
                </div>
        </header>

        <div style="min-height:80vh; display:flex; align-items:center; justify-content:center; padding:1rem;">
                <main class="card" role="main" aria-labelledby="main-title" style="max-width:720px; width:100%;">
                        <h1 id="main-title">{{ title or "Hello, World!" }}</h1>
                        <p class="lead">{{ message or "Welcome to your new web app. Use the navigation above to move around." }}</p>
                        <a class="btn" href="#">Say Hello</a>
                        <div id="message-area" aria-live="polite"></div>
                </main>
        </div>

        <script>
        // Simple client-side auth using localStorage.
        (function () {
            function getUser() { try { return JSON.parse(localStorage.getItem('user')); } catch(e){return null;} }
            function setUser(u){ localStorage.setItem('user', JSON.stringify(u)); }
            function clearUser(){ localStorage.removeItem('user'); }

            var loginLink = document.getElementById('login-link');
            var logoutBtn = document.getElementById('logout-btn');
            var userName = document.getElementById('user-name');

            function refreshNav(){
                var u = getUser();
                if (u && u.username){
                    userName.textContent = u.username;
                    loginLink.textContent = 'Profile';
                    loginLink.href = '/home';
                    logoutBtn.classList.remove('hidden');
                } else {
                    userName.textContent = '';
                    loginLink.textContent = 'Login';
                    loginLink.href = '/login';
                    logoutBtn.classList.add('hidden');
                }
            }

            document.addEventListener('DOMContentLoaded', function () {
                refreshNav();

                logoutBtn && logoutBtn.addEventListener('click', function (){
                    clearUser();
                    // After logout, send user to login page
                    window.location.href = '/login';
                });

                // small local demo interaction
                var btn = document.querySelector('.btn');
                var area = document.getElementById('message-area');
                if (btn && area) btn.addEventListener('click', function (e){ e.preventDefault(); area.textContent = 'Hello from the client!'; });
            });
        })();
        </script>
</body>
</html>
